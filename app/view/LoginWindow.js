/*
 * File: app/view/LoginWindow.js
 *
 * This file was generated by Sencha Architect version 4.2.4.
 * http://www.sencha.com/products/architect/
 *
 * This file requires use of the Ext JS 4.0.x library, under independent license.
 * License of Sencha Architect does not include license for Ext JS 4.0.x. For more
 * details see http://www.sencha.com/license or contact license@sencha.com.
 *
 * This file will be auto-generated each and everytime you save your project.
 *
 * Do NOT hand edit this file.
 */

Ext.define('GeZC_StartAdministratie.view.LoginWindow', {
    extend: 'Ext.window.Window',
    alias: 'widget.LoginWindow',

    requires: [
        'Ext.form.Panel',
        'Ext.form.field.Text',
        'Ext.Img',
        'Ext.button.Button'
    ],

    border: false,
    draggable: false,
    frame: true,
    height: 241,
    width: 512,
    resizable: false,
    bodyBorder: false,
    bodyCls: 'achtergrondlogo',
    closable: false,
    frameHeader: false,
    modal: true,
    plain: true,

    initComponent: function() {
        var me = this;

        Ext.applyIf(me, {
            items: [
                {
                    xtype: 'form',
                    border: false,
                    cls: '',
                    componentCls: '',
                    height: 150,
                    id: 'LoginForm',
                    width: 510,
                    layout: 'absolute',
                    bodyBorder: false,
                    bodyCls: 'doorzichtig',
                    bodyPadding: 10,
                    frameHeader: false,
                    title: '',
                    url: 'php/main.php?Action=Login.verkrijgToegang',
                    items: [
                        {
                            xtype: 'textfield',
                            anchor: '100%',
                            x: 160,
                            y: 40,
                            id: 'LoginGebruiker',
                            maxWidth: 150,
                            width: 150,
                            fieldLabel: 'Gebruiker',
                            labelAlign: 'right',
                            labelWidth: 75,
                            msgTarget: 'side',
                            name: 'USERNAME',
                            allowBlank: false
                        },
                        {
                            xtype: 'textfield',
                            anchor: '100%',
                            x: 160,
                            y: 70,
                            id: 'LoginWachtwoord',
                            maxWidth: 150,
                            width: 150,
                            fieldLabel: 'Wachtwoord',
                            labelAlign: 'right',
                            labelWidth: 75,
                            msgTarget: 'side',
                            name: 'PASSWORD',
                            inputType: 'password',
                            allowBlank: false,
                            listeners: {
                                specialkey: {
                                    fn: me.onLoginWachtwoordSpecialkey,
                                    scope: me
                                }
                            }
                        },
                        {
                            xtype: 'image',
                            x: 315,
                            y: 75,
                            hidden: true,
                            id: 'VerkeerdWachtwoord',
                            src: 'images/alert.png',
                            listeners: {
                                afterrender: {
                                    fn: me.onVerkeerdWachtwoordAfterRender,
                                    scope: me
                                }
                            }
                        },
                        {
                            xtype: 'button',
                            x: 170,
                            y: 100,
                            formBind: true,
                            height: 40,
                            id: 'Inloggen',
                            margin: '0px 240px',
                            padding: '',
                            width: 80,
                            text: 'Inloggen',
                            listeners: {
                                click: {
                                    fn: me.onButtonClick11,
                                    scope: me
                                }
                            }
                        }
                    ],
                    listeners: {
                        show: {
                            fn: me.onLoginFormShow,
                            scope: me
                        }
                    }
                }
            ]
        });

        me.callParent(arguments);
    },

    onLoginWachtwoordSpecialkey: function(field, e, eOpts) {
        if(e.getKey() == Ext.EventObject.ENTER)
        {
            var form = Ext.getCmp('LoginForm');
            form.getForm().submit
            ({
                success: function(req,res)
                {
                    button.up('.window').close();
                    location.reload();
                },
                failure: function(req,res)
                {
                    Ext.getCmp('VerkeerdWachtwoord').show();

                }
            });
        }
    },

    onVerkeerdWachtwoordAfterRender: function(component, eOpts) {
        Ext.QuickTips.register({
            target: component.getEl(),
            text: 'De combinatie gebruikersnaam / wachtwoord is ongeldig.'
        });
    },

    onButtonClick11: function(button, e, eOpts) {
        Ext.getCmp('Inloggen').disable();
        Ext.win.showLogin(true);

        var form = Ext.getCmp('LoginForm');
        form.getForm().submit
        ({
            success: function(req,res)
            {
                Ext.win.showLogin(false);
                button.up('.window').close();
                location.reload();
            },
            failure: function(req,res)
            {
                Ext.win.showLogin(false);
                Ext.getCmp('Inloggen').enable();

                Ext.getCmp('VerkeerdWachtwoord').show();

            }
        });
    },

    onLoginFormShow: function(component, eOpts) {
        Ext.getCmp('LoginForm').getForm().isValid();
    }

});